#+title: LTI Systems: A Rigorous Axiomatic Derivation from First Principles
#+author: SOV710
#+date: 2025-12-24
#+startup: showall
#+options: toc:2 num:nil

* 引言：为什么需要严格推导

在上一篇笔记中，我们介绍了信号与系统的基本概念。现在我们将用 *严格的数学推导*，从公理出发，一步步推出 LTI (Linear Time-Invariant) 系统的所有性质。

这不是工程上的 "差不多"，而是数学上的 *机械推导* —— 每一步都有明确的依据，没有跳跃，没有 "显然"。

*为什么这很重要？*

1. *理解本质*: 你会看到 LTI 系统的所有神奇性质 (卷积、频域分析、传递函数) 都来自两个简单的假设: 线性 + 时不变。

2. *工程直觉*: 当你知道某个结论是如何推导出来的，你就知道它在什么条件下成立，什么时候会失效。

3. *调试系统*: 当你的机器人控制器出问题时，知道理论基础能帮你定位是哪个假设被违反了 (比如饱和导致非线性)。

*路线图*:

#+begin_example
定义 (线性 + 时不变)
  ↓
定理 1,2 (冲激分解 + 移位响应)
  ↓
定理 3 (卷积表示) ← 核心
  ↓
定理 4-8 (复指数、卷积定理、因果性、稳定性)
#+end_example

* 公理与定义

** 定义 1: 系统

系统是一个 *映射* $\mathcal{T}: \mathcal{X} \to \mathcal{Y}$，将输入信号空间映射到输出信号空间。

记作: $y = \mathcal{T}\{x\}$

*数学上*: $\mathcal{T}$ 是一个 *算子* (operator)，可以是线性的也可以是非线性的。

*物理上*: 任何能把输入变成输出的东西都是系统 —— 电路、机械装置、控制器、滤波器。

** 定义 2: 线性 (Linearity)

系统 $\mathcal{T}$ 是 *线性的*，当且仅当对任意信号 $x_1, x_2$ 和标量 $a, b$:

$$\mathcal{T}\{ax_1 + bx_2\} = a\mathcal{T}\{x_1\} + b\mathcal{T}\{x_2\}$$

*这包含两个性质*:

1. *可加性* (Additivity): $\mathcal{T}\{x_1 + x_2\} = \mathcal{T}\{x_1\} + \mathcal{T}\{x_2\}$
2. *齐次性* (Homogeneity): $\mathcal{T}\{ax\} = a\mathcal{T}\{x\}$

*物理意义*: 叠加原理 —— 两个输入的响应等于各自响应的叠加。

*反例*:

- 平方器 $y = x^2$: $\mathcal{T}\{2x\} = 4x^2 \neq 2x^2 = 2\mathcal{T}\{x\}$ ✗
- 整流器 $y = |x|$: $\mathcal{T}\{-x\} = |x| \neq -|x| = -\mathcal{T}\{x\}$ ✗

** 定义 3: 时不变性 (Time-Invariance)

系统 $\mathcal{T}$ 是 *时不变的*，当且仅当对任意信号 $x$ 和时移 $t_0$ (或 $n_0$):

若 $y(t) = \mathcal{T}\{x(t)\}$，则 $y(t - t_0) = \mathcal{T}\{x(t - t_0)\}$

*物理意义*: 系统的特性不随时间改变。今天做的实验和明天做的结果一样。

*等价表述*: 时移和系统操作 *可交换*:

$$\text{Shift}_{t_0} \circ \mathcal{T} = \mathcal{T} \circ \text{Shift}_{t_0}$$

*反例*:

- 调制器 $y(t) = x(t)\cos(\omega_c t)$: 输出依赖绝对时间 $t$ ✗
- 自适应滤波器: 系数随时间变化 ✗

** 定义 4: 单位冲激

*离散*:

$$\delta[n] = \begin{cases} 1, & n = 0 \\ 0, & n \neq 0 \end{cases}$$

*连续*:

$\delta(t)$ 是 *广义函数* (distribution)，满足对任意连续函数 $f$:

$$\int_{-\infty}^{\infty} f(t)\delta(t - t_0) \, dt = f(t_0)$$

*数学上*: $\delta(t)$ 不是普通函数，而是一个 *泛函* (functional) —— 只在积分符号下有意义。

*物理上*: 理想化的瞬时脉冲 —— 无限窄、无限高、面积为 1。

** 定义 5: 冲激响应

系统对单位冲激 $\delta$ 的响应称为 *冲激响应*，记为 $h$:

$$h(t) = \mathcal{T}\{\delta(t)\} \quad \text{或} \quad h[n] = \mathcal{T}\{\delta[n]\}$$

*物理意义*: 冲激响应是系统的 "指纹" —— 它包含了系统的所有信息 (对 LTI 系统)。

*测量方法*:

- 理论上: 输入 $\delta(t)$，测量输出
- 实际上: 输入很窄的脉冲 (近似冲激)，测量响应

* 定理 1: 任意信号的冲激分解

** 离散时间

*定理陈述*: 任意信号 $x[n]$ 可表示为:

$$x[n] = \sum_{k=-\infty}^{\infty} x[k]\delta[n-k]$$

*证明*:

固定某个 $n = n_0$。

考虑右边:

$$\text{RHS} = \sum_{k=-\infty}^{\infty} x[k]\delta[n_0-k]$$

根据 $\delta$ 的定义，$\delta[n_0 - k]$ 只有当 $k = n_0$ 时为 1，其他为 0。

因此:

$$\sum_{k=-\infty}^{\infty} x[k]\delta[n_0-k] = x[n_0] \cdot 1 = x[n_0]$$

由于 $n_0$ 是任意的，得证。□

*物理意义*: 任何信号都可以看作一系列 *移位冲激的加权叠加*。

*类比*: 就像一个复杂的波形可以分解为一系列 "样本值"，每个样本对应一个冲激。

*工程应用*: 这是 *卷积* 和 *采样* 的数学基础。

** 连续时间

*定理陈述*: 任意信号 $x(t)$ 可表示为:

$$x(t) = \int_{-\infty}^{\infty} x(\tau)\delta(t-\tau) \, d\tau$$

*证明*:

根据 $\delta$ 的筛选性质 (定义 4)，直接得到:

$$\int_{-\infty}^{\infty} x(\tau)\delta(t-\tau) \, d\tau = x(t)$$

□

*理解*: 连续信号是 "连续无穷多" 个冲激的加权叠加。

*数学细节*: 严格来说，这需要 $x(t)$ 是 *连续* 的。对于不连续的信号，需要用 *测度论* 来处理。

* 定理 2: 时不变系统的移位冲激响应

*定理陈述*: 若系统 $\mathcal{T}$ 时不变，且 $h[n] = \mathcal{T}\{\delta[n]\}$，则:

$$\mathcal{T}\{\delta[n - k]\} = h[n - k]$$

*证明*:

设 $y[n] = \mathcal{T}\{\delta[n]\} = h[n]$

根据时不变性定义 (定义 3)，对任意 $k$:

$$\mathcal{T}\{\delta[n-k]\} = y[n-k] = h[n-k]$$

□

*物理意义*: 如果你知道系统对 $\delta[0]$ 的响应 $h[n]$，就自动知道对 $\delta[k]$ 的响应 $h[n-k]$ —— 只是时移而已。

*这是时不变性的直接后果*。

* 定理 3: LTI 系统的卷积表示 (核心定理)

*定理陈述*: 若系统 $\mathcal{T}$ 既线性又时不变，则对任意输入 $x$:

*离散*:

$$y[n] = \mathcal{T}\{x[n]\} = \sum_{k=-\infty}^{\infty} x[k]h[n-k] = (x * h)[n]$$

*连续*:

$$y(t) = \mathcal{T}\{x(t)\} = \int_{-\infty}^{\infty} x(\tau)h(t-\tau) \, d\tau = (x * h)(t)$$

** 证明 (离散情况)

*步骤 1*: 用定理 1 分解输入

$$x[n] = \sum_{k=-\infty}^{\infty} x[k]\delta[n-k]$$

*步骤 2*: 应用系统

$$y[n] = \mathcal{T}\{ x[n] \} = \mathcal{T}\left\{ \sum_{k=-\infty}^{\infty} x[k]\,\delta[n-k] \right\}$$

*步骤 3*: 利用线性 (定义 2)，求和与系统可交换

$$y[n] = \sum_{k=-\infty}^{\infty} x[k] \mathcal{T}\{\delta[n-k]\}$$

*关键*: 这里 $x[k]$ 是常数 (固定的 $k$)，可以提出来。

*为什么可以交换？* 因为线性允许我们把 "对和的操作" 变成 "和的操作"。

*步骤 4*: 利用定理 2 (时不变性)

$$\mathcal{T}\{\delta[n-k]\} = h[n-k]$$

*步骤 5*: 代入

$$y[n] = \sum_{k=-\infty}^{\infty} x[k]h[n-k]$$

这正是 *卷积* 的定义。□

** 证明 (连续情况)

完全类似，只是求和变积分:

$$y(t) = \mathcal{T}\{ x(t) \} = \mathcal{T}\left\{ \int_{-\infty}^{\infty} x(\tau)\,\delta(t-\tau)\,d\tau \right\}$$

利用线性:

$$= \int_{-\infty}^{\infty} x(\tau) \mathcal{T}\{\delta(t-\tau)\} \, d\tau$$

利用时不变:

$$= \int_{-\infty}^{\infty} x(\tau) h(t-\tau) \, d\tau$$

□

** 推论 3.1: LTI 系统完全由冲激响应刻画

*证明*: 定理 3 直接给出了 $y$ 与 $x, h$ 的关系。知道 $h$ 就能计算任意输入的输出。□

*工程意义*: 你只需要测量 *一次* 冲激响应，就知道系统对 *任何* 输入的响应！

*这是 LTI 系统最强大的性质。*

** 卷积的直观理解

卷积可以看作三个步骤:

1. *反转* (Flip): $h[k] \to h[-k]$
2. *移位* (Shift): $h[-k] \to h[n-k]$
3. *乘加* (Multiply-Accumulate): $\sum_k x[k]h[n-k]$

*物理意义*: 系统的 "记忆" 与输入的 "加权叠加"。

*在你的代码中*:

#+begin_src c
// 离散卷积 (FIR 滤波器)
float convolve(float x[], float h[], int N, int M, int n) {
    float y = 0;
    for (int k = 0; k < M; k++) {
        if (n - k >= 0 && n - k < N) {
            y += x[n - k] * h[k];
        }
    }
    return y;
}
#+end_src

* 定理 4: 复指数是 LTI 系统的特征函数

*定理陈述*: 对 LTI 系统，若输入 $x(t) = e^{st}$ (其中 $s \in \mathbb{C}$)，则输出:

$$y(t) = H(s) e^{st}$$

其中 $H(s) = \int_{-\infty}^{\infty} h(\tau)e^{-s\tau} \, d\tau$ (常数，不依赖 $t$)

** 证明

*步骤 1*: 应用定理 3 (卷积)

$$y(t) = \int_{-\infty}^{\infty} h(\tau) x(t-\tau) \, d\tau$$

*步骤 2*: 代入 $x(t) = e^{st}$

$$y(t) = \int_{-\infty}^{\infty} h(\tau) e^{s(t-\tau)} \, d\tau$$

*步骤 3*: 提取 $e^{st}$ (它不依赖积分变量 $\tau$)

$$y(t) = e^{st} \int_{-\infty}^{\infty} h(\tau) e^{-s\tau} \, d\tau$$

*步骤 4*: 定义 $H(s)$

$$H(s) := \int_{-\infty}^{\infty} h(\tau) e^{-s\tau} \, d\tau$$

*这是拉普拉斯变换或傅里叶变换 (当 $s = j\omega$)！*

*步骤 5*: 得到

$$y(t) = H(s) e^{st}$$

注意 $H(s)$ 是关于 $s$ 的函数，但 *不依赖 $t$*，所以相对于时间它是常数。□

** 推论 4.1: 复指数的不变性

*推论*: 复指数通过 LTI 系统时，*形式不变* (仍是同频率复指数)，只改变幅度和相位。

*证明*: $H(s)$ 是复数，可写成 $H(s) = |H(s)|e^{j\angle H(s)}$，所以输出仍是 $e^{st}$ 的倍数。□

*物理意义*: 这就是为什么我们用正弦波测试系统 (频率响应)！

*例子*: Bode 图

在控制系统中，你用不同频率的正弦信号输入:

$$x(t) = \sin(\omega t)$$

输出也是正弦:

$$y(t) = |H(j\omega)| \sin(\omega t + \angle H(j\omega))$$

- *幅度*: $|H(j\omega)|$ (增益)
- *相位*: $\angle H(j\omega)$ (相位滞后)

画出 $|H(j\omega)|$ 和 $\angle H(j\omega)$ 随 $\omega$ 的变化，就是 Bode 图。

** 离散时间的对应结果

对离散 LTI 系统，若输入 $x[n] = z^n$ (其中 $z \in \mathbb{C}$)，则输出:

$$y[n] = H(z) z^n$$

其中:

$$H(z) = \sum_{k=-\infty}^{\infty} h[k]z^{-k}$$

这是 *Z 变换*。

* 定理 5: 卷积的交换律

*定理陈述*:

$$x * h = h * x$$

** 证明 (离散)

$$x * h = \sum_{k=-\infty}^{\infty} x[k]h[n-k]$$

令 $m = n - k$，则 $k = n - m$，$dk = -dm$:

$$= \sum_{m=-\infty}^{\infty} x[n-m]h[m] = \sum_{m=-\infty}^{\infty} h[m]x[n-m] = h * x$$

□

** 物理意义

输入和系统的 "角色" 对称。

*这意味着*:

- 把信号 $x$ 通过系统 $h$
- 等价于把 "信号 $h$" 通过 "系统 $x$"

虽然物理上可能没有意义 (系统不是信号)，但数学上完全对称。

** 结合律和分配律

卷积还满足:

*结合律*:

$$(x * h_1) * h_2 = x * (h_1 * h_2)$$

*分配律*:

$$x * (h_1 + h_2) = x * h_1 + x * h_2$$

*这些性质使得系统互联 (串联、并联) 的分析变得简单。*

* 定理 6: 卷积定理 (时域卷积 ↔ 频域相乘)

*定理陈述*: 若 $X(\omega)$, $H(\omega)$ 分别是 $x(t)$, $h(t)$ 的傅里叶变换，则:

$$y(t) = (x * h)(t) \quad \Leftrightarrow \quad Y(\omega) = X(\omega)H(\omega)$$

** 证明

*步骤 1*: $Y(\omega)$ 的定义

$$Y(\omega) = \int_{-\infty}^{\infty} y(t)e^{-j\omega t} \, dt$$

*步骤 2*: 代入 $y(t) = \int_{-\infty}^{\infty} x(\tau)h(t-\tau) \, d\tau$

$$Y(\omega) = \int_{-\infty}^{\infty} \left[\int_{-\infty}^{\infty} x(\tau)h(t-\tau) \, d\tau\right] e^{-j\omega t} \, dt$$

*步骤 3*: 交换积分次序 (Fubini 定理，假设收敛)

$$= \int_{-\infty}^{\infty} x(\tau) \left[\int_{-\infty}^{\infty} h(t-\tau) e^{-j\omega t} \, dt\right] d\tau$$

*步骤 4*: 内层积分换元，令 $u = t - \tau$，则 $t = u + \tau$，$dt = du$

$$\int_{-\infty}^{\infty} h(t-\tau) e^{-j\omega t} \, dt = \int_{-\infty}^{\infty} h(u) e^{-j\omega(u+\tau)} \, du$$

*步骤 5*: 分离指数

$$= e^{-j\omega\tau} \int_{-\infty}^{\infty} h(u) e^{-j\omega u} \, du = e^{-j\omega\tau} H(\omega)$$

*步骤 6*: 代回

$$Y(\omega) = \int_{-\infty}^{\infty} x(\tau) e^{-j\omega\tau} H(\omega) \, d\tau$$

*步骤 7*: $H(\omega)$ 不依赖 $\tau$，提出来

$$= H(\omega) \int_{-\infty}^{\infty} x(\tau) e^{-j\omega\tau} \, d\tau = H(\omega) X(\omega)$$

□

** 推论 6.1: 频域分析简化为代数

*LTI 系统在频域的分析变成代数 (乘法)，而非微积分 (卷积)。*

*这是频域分析的核心优势！*

*工程应用*:

- 时域: $y(t) = x(t) * h(t)$ → 需要计算积分 (复杂)
- 频域: $Y(\omega) = X(\omega)H(\omega)$ → 只需要乘法 (简单)

*典型流程*:

1. 把 $x(t)$ 变换到频域: $X(\omega)$
2. 乘以系统频率响应: $Y(\omega) = H(\omega)X(\omega)$
3. 反变换回时域: $y(t)$

虽然多了两次变换，但对于复杂系统，频域计算 *远比* 时域卷积简单。

** 离散时间的对应结果

对离散信号:

$$y[n] = x[n] * h[n] \quad \Leftrightarrow \quad Y(e^{j\Omega}) = X(e^{j\Omega})H(e^{j\Omega})$$

其中 $X(e^{j\Omega})$, $H(e^{j\Omega})$ 是 DTFT (Discrete-Time Fourier Transform)。

* 定理 7: 因果性的时域条件

*定理陈述*: LTI 系统因果，当且仅当:

$$h(t) = 0, \quad \forall t < 0 \quad \text{(连续)}$$

$$h[n] = 0, \quad \forall n < 0 \quad \text{(离散)}$$

** 证明 (必要性)

假设系统因果。考虑输入:

$$x(t) = \delta(t)$$

这个输入在 $t < 0$ 时为 0。

根据因果性，输出 $y(t) = h(t)$ 在 $t < 0$ 时也必须为 0 (不能依赖未来输入)。

因此 $h(t) = 0$ for $t < 0$。□

** 证明 (充分性)

假设 $h(t) = 0$ for $t < 0$。

对任意因果输入 $x(t)$ (即 $x(t) = 0$ for $t < t_0$)，输出为:

$$y(t) = \int_{-\infty}^{\infty} h(\tau)x(t-\tau) \, d\tau$$

当 $t < t_0$ 时，对所有 $\tau$:

- 若 $\tau < 0$: $h(\tau) = 0$
- 若 $\tau \geq 0$: $t - \tau < t_0$，所以 $x(t-\tau) = 0$

因此积分为 0，$y(t) = 0$ for $t < t_0$，系统因果。□

** 物理意义

*冲激响应在 $t < 0$ 时为 0* 意味着系统 "不预测未来"。

*检查因果性*: 画出 $h(t)$，看 $t < 0$ 部分是否为 0。

*例子*:

- *因果*: $h(t) = e^{-at}u(t)$ (指数衰减，$t < 0$ 时为 0) ✓
- *非因果*: $h(t) = e^{-a|t|}$ ($t < 0$ 时非 0) ✗

** 频域条件 (补充)

在频域，因果性对应 *Paley-Wiener 条件*:

$$\int_{-\infty}^{\infty} \frac{|\ln|H(\omega)||}{1 + \omega^2} \, d\omega < \infty$$

这个条件限制了 $H(\omega)$ 的衰减速度 —— 不能衰减得 "太快"。

*物理意义*: 因果系统的频率响应不能在某些频率上完全为 0 (理想低通滤波器不因果)。

* 定理 8: BIBO 稳定性条件

*定理陈述*: LTI 系统 BIBO 稳定，当且仅当:

$$\int_{-\infty}^{\infty} |h(t)| \, dt < \infty \quad \text{或} \quad \sum_{n=-\infty}^{\infty} |h[n]| < \infty$$

** 证明 (充分性，离散)

假设 $\sum_n |h[n]| < \infty$，记为 $M_h$。

设输入有界: $|x[n]| \leq M_x$ for all $n$。

输出为:

$$y[n] = \sum_{k=-\infty}^{\infty} x[k]h[n-k]$$

取绝对值 (三角不等式):

$$|y[n]| = \left|\sum_{k=-\infty}^{\infty} x[k]h[n-k]\right| \leq \sum_{k=-\infty}^{\infty} |x[k]||h[n-k]|$$

利用 $|x[k]| \leq M_x$:

$$\leq M_x \sum_{k=-\infty}^{\infty} |h[n-k]| = M_x \sum_{m=-\infty}^{\infty} |h[m]| = M_x M_h$$

因此 $|y[n]| \leq M_x M_h < \infty$，输出有界。□

** 证明 (必要性)

*反证法*。假设 $\sum_n |h[n]| = \infty$。

构造输入:

$$x[k] = \begin{cases} \frac{h^*[-k]}{|h[-k]|}, & h[-k] \neq 0 \\ 0, & h[-k] = 0 \end{cases}$$

其中 $h^*$ 是复共轭。

这个输入 *有界* ($|x[k]| = 1$)。

在 $n = 0$ 时的输出:

$$y[0] = \sum_{k=-\infty}^{\infty} x[k]h[-k] = \sum_{k: h[-k] \neq 0} \frac{h^*[-k]}{|h[-k]|} h[-k] = \sum_{k} |h[-k]| = \sum_m |h[m]| = \infty$$

输出 *无界*，矛盾。□

** 物理意义

*$\sum |h[n]| < \infty$ 意味着冲激响应必须 "足够快" 地衰减到 0。*

*不稳定的例子*:

- *积分器*: $h(t) = u(t)$
  - $\int_0^\infty 1 \, dt = \infty$ ✗
- *累加器*: $h[n] = u[n]$
  - $\sum_{n=0}^\infty 1 = \infty$ ✗

*稳定的例子*:

- *指数衰减*: $h(t) = e^{-at}u(t)$，$a > 0$
  - $\int_0^\infty e^{-at} \, dt = 1/a < \infty$ ✓
- *几何衰减*: $h[n] = a^n u[n]$，$|a| < 1$
  - $\sum_{n=0}^\infty |a|^n = 1/(1-|a|) < \infty$ ✓

** 频域条件 (补充)

在频域，稳定性可以用 *极点* 来判断:

*连续时间*: 所有极点 (传递函数 $H(s)$ 的极点) 必须在 *左半平面* (实部 < 0)。

*离散时间*: 所有极点 (传递函数 $H(z)$ 的极点) 必须在 *单位圆内* ($|z| < 1$)。

*你的控制系统设计*: 通过调整参数 (如 PID 增益)，使极点位于稳定区域。

* 总结: 从公理到性质的演绎链

#+begin_example
定义 1,2,3 (系统 + 线性 + 时不变)
    ↓
定理 1 (冲激分解) + 定理 2 (移位响应)
    ↓
定理 3 (卷积表示) ← LTI 系统的核心
    ↓
    ├→ 定理 4 (复指数特征函数)
    │      ↓
    │  频域分析、传递函数
    │
    ├→ 定理 6 (卷积定理)
    │      ↓
    │  频域变成代数运算
    │
    ├→ 定理 7 (因果性条件)
    │      ↓
    │  h(t) = 0 for t < 0
    │
    └→ 定理 8 (稳定性条件)
           ↓
       ∫|h(t)|dt < ∞
#+end_example

* 关键观察

** 从两个性质推出整个理论

*线性 + 时不变* → *卷积表示* (定理 3)

- 这是最核心的一步
- 只需要两个性质的 *定义*
- 证明过程是 *机械的*，没有跳跃

*卷积表示* → *所有其他性质*

- 复指数特征函数 (定理 4)
- 频域分析 (定理 6)
- 因果/稳定条件 (定理 7, 8)

*这就是为什么 LTI 系统如此特殊* —— 从两个简单的性质 (线性 + 时不变)，机械地推出了整个理论体系。

** 卷积是核心

*所有 LTI 系统的分析* 都归结为卷积:

$$y = x * h$$

*时域*: 直接计算卷积 (适合数值计算)

*频域*: 转换为乘法 (适合符号计算和分析)

*你在实际应用中*:

- 设计滤波器 → 确定 $h[n]$
- 分析系统 → 计算 $Y(\omega) = X(\omega)H(\omega)$
- 实现系统 → 用卷积或递归差分方程

** 数学严谨性的价值

*为什么要这么严格？*

1. *避免错误*: 知道每个结论的 *前提条件* (线性、时不变、因果、稳定...)

2. *推广*: 当条件不满足时 (非线性、时变)，知道哪些结论失效

3. *调试*: 系统出问题时，检查哪个假设被违反了

*例子*:

- 你的 PID 控制器输出饱和了 → *非线性*，卷积失效
- 电池电压下降，电机响应变慢 → *时变*，$h(t)$ 不再固定
- 积分项累积过大 → *不稳定*，$\sum |h[n]| = \infty$

* 实际应用: 从理论到工程

** 设计数字滤波器

*目标*: 去除传感器噪声 (比如 IMU 的高频抖动)。

*步骤*:

1. *确定冲激响应* $h[n]$:
   - 移动平均: $h[n] = \frac{1}{M}$ for $0 \leq n < M$
   - 指数平滑: $h[n] = (1-\alpha)\alpha^n u[n]$

2. *验证因果性*: $h[n] = 0$ for $n < 0$？ ✓

3. *验证稳定性*: $\sum |h[n]| < \infty$？ ✓

4. *计算频率响应*:
   $$H(e^{j\Omega}) = \sum_{n=0}^{M-1} h[n]e^{-j\Omega n}$$

5. *检查截止频率*: $|H(e^{j\Omega})|$ 在什么频率下降到 -3dB？

6. *实现*:
   #+begin_src c
   float y = 0;
   for (int k = 0; k < M; k++) {
       y += h[k] * x[n - k];
   }
   #+end_src

** 分析控制系统

*目标*: 设计 PID 控制器，使系统稳定且快速响应。

*步骤*:

1. *建模*: 用传递函数 $H(s)$ 表示系统

2. *频域分析*: 画 Bode 图，看增益裕度和相位裕度

3. *极点配置*: 调整 PID 参数，使闭环极点在左半平面

4. *仿真*: 用卷积计算阶跃响应，检查超调和稳态误差

5. *实现*: 离散化为差分方程，在 STM32 上运行

** 音频处理

*目标*: 实现均衡器 (EQ)，增强某些频率。

*步骤*:

1. *频域设计*: 确定 $H(\omega)$ (比如 10kHz 提升 6dB)

2. *反变换*: $h(t) = \mathcal{F}^{-1}\{H(\omega)\}$

3. *窗函数*: 截断 $h(t)$ 到有限长度 (如 Hamming 窗)

4. *实现*: 用 FFT 加速卷积

* 拓展阅读和深入主题

** 更高级的理论

1. *广义函数论* (Distribution Theory): 严格定义 $\delta(t)$

2. *算子理论* (Operator Theory): 用算子观点看系统

3. *信号空间* (Signal Spaces): $L^2$, $l^2$ 等 Hilbert 空间

4. *采样理论* (Sampling Theory): Nyquist-Shannon 定理的严格证明

** 非 LTI 系统

1. *线性时变* (LTV): 线性但不时不变
   - 例子: 自适应滤波器
   - 用 *时变卷积* $y(t) = \int h(t,\tau)x(\tau) \, d\tau$

2. *非线性时不变*: 时不变但不线性
   - 例子: 压缩器、限幅器
   - 用 *Volterra 级数* 近似

3. *非线性时变*: 既不线性也不时不变
   - 例子: 开关电源、变速电机
   - 需要状态空间方法

** 实际系统的非理想性

1. *量化噪声*: ADC/DAC 的有限精度

2. *计算延迟*: 数字滤波器的处理时间

3. *饱和*: 执行器的物理限制

4. *参数漂移*: 温度、老化导致的时变

*工程实践*: 用 LTI 理论设计，但要考虑非理想因素的影响。

* 总结: LTI 系统的优雅

LTI 系统理论是 *信号与系统* 中最优雅的部分:

1. *简单的假设*: 线性 + 时不变

2. *强大的结论*: 卷积、频域分析、传递函数

3. *严格的推导*: 从公理出发，步步为营

4. *广泛的应用*: 滤波、控制、通信、音频处理

*核心思想*:

- *时域*: $y = x * h$ (卷积)
- *频域*: $Y = X \cdot H$ (乘法)
- *冲激响应* $h$ 包含系统的所有信息

*下一步*:

在实际工程中 (机器人控制、嵌入式系统、信号处理)，应用这些理论:

- 设计滤波器
- 分析稳定性
- 优化性能

*记住*: 理论是工具，不是目的。理解理论的 *边界* (什么时候成立，什么时候失效) 比背诵公式更重要。

当你的系统出现非线性 (饱和)、时变 (参数漂移)、或噪声 (量化误差) 时，知道 LTI 理论的 *局限性*​，才能找到正确的解决方案。
