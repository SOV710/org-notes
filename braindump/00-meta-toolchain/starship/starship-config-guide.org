#+title: Starship Configuration Guide: Prompt Customization Directions and Strategies
#+author: SOV710
#+date: 2025-01-02
#+startup: showall
#+options: toc:2 num:nil

* æ–‡æ¡£é€‚ç”¨ç‰ˆæœ¬

æœ¬ç¬”è®°åŸºäº *Starship v1.24.2* (2024-12-30) æ’°å†™ã€‚Starship æ˜¯ä¸€ä¸ªå¿«é€Ÿè¿­ä»£çš„é¡¹ç›®, æœªæ¥ç‰ˆæœ¬å¯èƒ½ä¼šå¼•å…¥ breaking changesã€‚æœ¬æ–‡æ¡£åªè®°å½•å½“å‰ç¨³å®šç‰ˆæœ¬çš„ç‰¹æ€§, ä¸åŒ…å«ä»»ä½•å·² deprecated çš„é…ç½®é¡¹ã€‚

* Starship é…ç½®ä½“ç³»æ¦‚è§ˆ

Starship çš„æ‰€æœ‰é…ç½®é€šè¿‡å•ä¸€ TOML æ–‡ä»¶ =~/.config/starship.toml= å®Œæˆã€‚é…ç½®ä½“ç³»åˆ†ä¸ºä¸‰ä¸ªå±‚æ¬¡:

1. *Prompt-wide settings*: å…¨å±€è¡Œä¸º (format, timeout, scan behavior)
2. *Module configuration*: å„åŠŸèƒ½æ¨¡å—çš„å¯ç”¨/ç¦ç”¨ã€è§¦å‘æ¡ä»¶ã€æ˜¾ç¤ºæ ¼å¼
3. *Advanced customization*: ç¬æ€æç¤º (transient prompt)ã€é’©å­å‡½æ•°ã€æ ·å¼ç³»ç»Ÿ

** é…ç½®æ–‡ä»¶ä½ç½®

é»˜è®¤ä½ç½®: =~/.config/starship.toml=

é€šè¿‡ç¯å¢ƒå˜é‡è‡ªå®šä¹‰:

#+begin_src bash
export STARSHIP_CONFIG=~/dotfiles/starship.toml
#+end_src

** é…ç½®æ–‡ä»¶ç»“æ„

#+begin_src toml
# Schema è‡ªåŠ¨è¡¥å…¨ (æ”¯æŒ VSCode/Neovim LSP)
"$schema" = 'https://starship.rs/config-schema.json'

# å…¨å±€é…ç½®
add_newline = true
command_timeout = 500
scan_timeout = 30
format = '$all'
right_format = ''

# è°ƒè‰²æ¿ (Palette)
palette = 'catppuccin_mochiato'

[palettes.catppuccin_mochiato]
rosewater = '#f4dbd6'
flamingo = '#f0c6c6'
pink = '#f5bde6'
# ...

# æ¨¡å—é…ç½®
[character]
success_symbol = '[â¯](bold green)'
error_symbol = '[â¯](bold red)'

[directory]
truncation_length = 3
truncate_to_repo = true

[git_branch]
symbol = ' '
format = 'on [$symbol$branch]($style) '
#+end_src

* å…¨å±€é…ç½®é€‰é¡¹ (Prompt-Wide Settings)

** Format String ç³»ç»Ÿ

=format= å®šä¹‰äº†æç¤ºç¬¦çš„ç»„æˆå’Œé¡ºåºã€‚ä¸‰ç§ä¹¦å†™æ–¹å¼:

1. *ä½¿ç”¨* =$all=: åŒ…å«æ‰€æœ‰å¯ç”¨çš„æ¨¡å— (æŒ‰é»˜è®¤é¡ºåº)
2. *æ˜¾å¼åˆ—å‡ºæ¨¡å—*: å®Œå…¨æ§åˆ¶é¡ºåºå’ŒåŒ…å«å…³ç³»
3. *æ··åˆæ–¹å¼*: =$all= + è‡ªå®šä¹‰ä½ç½®çš„ç‰¹å®šæ¨¡å—

#+begin_src toml
# æ–¹å¼ 1: é»˜è®¤é¡ºåº
format = '$all'

# æ–¹å¼ 2: è‡ªå®šä¹‰é¡ºåº
format = '''
[â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>](bold green)
[â”‚](bold green)$directory$rust$package
[â””â”€>](bold green) '''

# æ–¹å¼ 3: ç§»åŠ¨ç‰¹å®šæ¨¡å—åˆ°æ–°ä½ç½®
format = '$all$directory$character'
#+end_src

*** Format String è¯­æ³•

*å˜é‡*: =$module_name= æ’å…¥æ¨¡å—è¾“å‡º

#+begin_src toml
format = '$username@$hostname:$directory'
#+end_src

*æ–‡æœ¬ç»„ (Text Group)*: =[content](style)= æ ¼å¼

#+begin_src toml
format = '[on](red bold) [$symbol$branch](green)'
#+end_src

*æ¡ä»¶æ¸²æŸ“*: =(...)= åŒ…è£¹çš„å†…å®¹, å½“å†…éƒ¨æ‰€æœ‰å˜é‡ä¸ºç©ºæ—¶æ•´ç»„ä¸æ˜¾ç¤º

#+begin_src toml
format = '($region) '  # region ä¸ºç©ºæ—¶æ•´ä¸ªæ‹¬å·éƒ½ä¸æ˜¾ç¤º
#+end_src

** è¶…æ—¶é…ç½®

| é€‰é¡¹            | é»˜è®¤å€¼ | è¯´æ˜                 |
|-----------------+-------+----------------------|
| =command_timeout= |   500 | æ‰§è¡Œå¤–éƒ¨å‘½ä»¤çš„è¶…æ—¶ (ms) |
| =scan_timeout=    |    30 | æ‰«ææ–‡ä»¶ç³»ç»Ÿçš„è¶…æ—¶ (ms) |

#+begin_src toml
command_timeout = 1000  # ç»™æ…¢é€Ÿå‘½ä»¤æ›´å¤šæ—¶é—´
scan_timeout = 10       # å¿«é€Ÿæ‰«æç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ
#+end_src

** ç¬¦å·é“¾æ¥å¤„ç†

#+begin_src toml
follow_symlinks = false  # ä¸è·Ÿéšç¬¦å·é“¾æ¥æ£€æŸ¥ç›®å½•ç±»å‹
#+end_src

*é€‚ç”¨åœºæ™¯*: å½“é¡¹ç›®ç›®å½•é€šè¿‡ NFS/CIFS æŒ‚è½½æ—¶, ç¦ç”¨å¯æ˜¾è‘—æé€Ÿã€‚

** è¡Œä¸ºé…ç½®

#+begin_src toml
add_newline = false      # æç¤ºç¬¦å‰ä¸æ’å…¥ç©ºè¡Œ
#+end_src

* Module é…ç½®çš„ä¸‰ä¸ªç»´åº¦

æ¯ä¸ª module éƒ½å¯ä»¥ä»ä¸‰ä¸ªç»´åº¦é…ç½®:

1. *è§¦å‘æ¡ä»¶ (Detection)*: ä½•æ—¶æ˜¾ç¤ºè¯¥æ¨¡å—
2. *æ˜¾ç¤ºå†…å®¹ (Format)*: æ˜¾ç¤ºä»€ä¹ˆä¿¡æ¯, å¦‚ä½•æ’ç‰ˆ
3. *æ ·å¼ (Style)*: é¢œè‰²ã€ç²—ä½“ã€ä¸‹åˆ’çº¿ç­‰è§†è§‰æ•ˆæœ

** è§¦å‘æ¡ä»¶é…ç½®

æ‰€æœ‰æ£€æµ‹ç±»æ¨¡å—éƒ½æ”¯æŒ:

- =detect_extensions=: åŒ¹é…æ–‡ä»¶æ‰©å±•å (å¦‚ =['py', 'ipynb']=)
- =detect_files=: åŒ¹é…å®Œæ•´æ–‡ä»¶å (å¦‚ =['Cargo.toml', 'Cargo.lock']=)
- =detect_folders=: åŒ¹é…ç›®å½•å (å¦‚ =['node_modules']=)
- =detect_env_vars=: åŒ¹é…ç¯å¢ƒå˜é‡ (å¦‚ =['VIRTUAL_ENV']=)

*Negative Matching*: ä½¿ç”¨ =!= å‰ç¼€æ’é™¤

#+begin_src toml
[nodejs]
detect_extensions = ['js', 'mjs', 'cjs', 'ts', '!video.ts']
detect_files = ['package.json', '!package-lock.json']
#+end_src

*å·¥ä½œåŸç†*: ä»»ä½•è´Ÿå‘åŒ¹é…å‘½ä¸­, æ¨¡å— *ç«‹å³ç¦ç”¨*, å³ä½¿æœ‰å…¶ä»–æ­£å‘åŒ¹é…ã€‚

** Format String é…ç½®

æ¯ä¸ªæ¨¡å—éƒ½æœ‰ =format= é€‰é¡¹, å®šä¹‰å…¶è¾“å‡ºæ ¼å¼ã€‚ä½¿ç”¨æ¨¡å—ç‰¹å®šçš„å˜é‡ã€‚

#+begin_src toml
[git_branch]
format = 'on [$symbol$branch(:$remote_branch)]($style) '
# å˜é‡: $symbol, $branch, $remote_branch, $style
#+end_src

*å˜é‡ä½œç”¨åŸŸ*: æ¨¡å—å˜é‡åªèƒ½åœ¨è¯¥æ¨¡å—çš„ format ä¸­ä½¿ç”¨, ä¸èƒ½è·¨æ¨¡å—å¼•ç”¨ã€‚

** æ ·å¼é…ç½®

=style= é€‰é¡¹æ¥å— *style string*, è¯­æ³•:

#+begin_src
'[modifier] [modifier] fg:<color> bg:<color>'
#+end_src

*Modifiers*: =bold=, =italic=, =underline=, =dimmed=, =inverted=, =strikethrough=

*Colors*:
- æ ‡å‡†è‰²: =red=, =green=, =blue=, =yellow=, =purple=, =cyan=, =white=, =black=
- é«˜äº®è‰²: =bright-red=, =bright-green=, ...
- 256 è‰²: æ•°å­— =0-255=
- RGB: =#RRGGBB= æ ¼å¼
- ç‰¹æ®Š: =prev_fg=, =prev_bg= (ç»§æ‰¿å‰ä¸€ä¸ªå…ƒç´ çš„é¢œè‰²)

#+begin_src toml
[character]
success_symbol = '[â¯](bold green)'
error_symbol = '[â¯](bold red)'

[directory]
style = 'bold cyan'

[git_status]
style = 'fg:208 bg:#1e1e2e'  # 256è‰² + RGBèƒŒæ™¯
#+end_src

* æ¨¡å—é…ç½®ç­–ç•¥

** æŒ‰åŠŸèƒ½åˆ†ç±»

*** 1. Shell çŠ¶æ€æ¨¡å—

| æ¨¡å—         | æ˜¾ç¤ºå†…å®¹        | å…¸å‹åœºæ™¯        |
|--------------+----------------+----------------|
| =character=    | æç¤ºç¬¦ (â¯/âœ–)   | åŒºåˆ†å‘½ä»¤æˆåŠŸ/å¤±è´¥ |
| =cmd_duration= | å‘½ä»¤è€—æ—¶        | ç›‘æ§æ…¢å‘½ä»¤       |
| =jobs=         | åå°ä»»åŠ¡æ•°       | æé†’æœªå®Œæˆä»»åŠ¡    |
| =status=       | é€€å‡ºç           | è°ƒè¯•è„šæœ¬        |
| =shell=        | å½“å‰ shell ç±»å‹ | å¤š shell ç¯å¢ƒ   |

*é…ç½®ç¤ºä¾‹*:

#+begin_src toml
[character]
success_symbol = '[âœ](bold green)'
error_symbol = '[âœ—](bold red)'
vimcmd_symbol = '[â®](bold green)'  # Vim æ¨¡å¼æç¤º

[cmd_duration]
min_time = 2000  # è¶…è¿‡ 2s æ‰æ˜¾ç¤º
format = 'took [$duration]($style) '
show_notifications = true  # æ¡Œé¢é€šçŸ¥ (é•¿æ—¶é—´å‘½ä»¤)
min_time_to_notify = 45000

[jobs]
symbol = 'âœ¦ '
number_threshold = 2  # >= 2 ä¸ªä»»åŠ¡æ‰æ˜¾ç¤ºæ•°å­—
symbol_threshold = 1  # >= 1 ä¸ªä»»åŠ¡æ˜¾ç¤ºç¬¦å·
#+end_src

*** 2. è·¯å¾„å’Œç‰ˆæœ¬æ§åˆ¶

| æ¨¡å—        | æ˜¾ç¤ºå†…å®¹      | å…³é”®é…ç½®                             |
|-------------+--------------+-------------------------------------|
| =directory=   | å½“å‰ç›®å½•      | =truncation_length=, =truncate_to_repo= |
| =git_branch=  | Git åˆ†æ”¯     | =ignore_branches=, =truncation_length=  |
| =git_status=  | Git å·¥ä½œåŒºçŠ¶æ€ | æœªè·Ÿè¸ª/å·²ä¿®æ”¹/å·²æš‚å­˜ç¬¦å·                |
| =git_commit=  | Commit hash  | =commit_hash_length=, =tag_symbol=      |
| =git_state=   | Git æ“ä½œçŠ¶æ€  | REBASING/MERGING/BISECTING          |
| =git_metrics= | å¢åˆ è¡Œæ•°      | =only_nonzero_diffs=                  |

*é…ç½®ç¤ºä¾‹*:

#+begin_src toml
[directory]
truncation_length = 4
truncate_to_repo = true
truncation_symbol = 'â€¦/'
read_only = ' ğŸ”’'
format = '[$path]($style)[$read_only]($read_only_style) '

[git_branch]
symbol = ' '
format = 'on [$symbol$branch(:$remote_branch)]($style) '
truncation_length = 20
truncation_symbol = 'â€¦'
ignore_branches = ['master', 'main']  # ä¸æ˜¾ç¤ºè¿™äº›åˆ†æ”¯

[git_status]
format = '([\[$all_status$ahead_behind\]]($style) )'
conflicted = '='
ahead = 'â‡¡${count}'
behind = 'â‡£${count}'
diverged = 'â‡•â‡¡${ahead_count}â‡£${behind_count}'
untracked = '?${count}'
stashed = '\$${count}'
modified = '!${count}'
staged = '+${count}'
renamed = 'Â»${count}'
deleted = 'âœ˜${count}'

[git_metrics]
disabled = false
added_style = 'bold green'
deleted_style = 'bold red'
format = '[+$added]($added_style)/[-$deleted]($deleted_style) '
#+end_src

*** 3. ç¼–ç¨‹è¯­è¨€ç‰ˆæœ¬

*æ£€æµ‹æœºåˆ¶*: æ‰€æœ‰è¯­è¨€æ¨¡å—éƒ½åŸºäºæ–‡ä»¶/ç›®å½•æ£€æµ‹è§¦å‘ã€‚

| æ¨¡å—       | æ£€æµ‹æ–‡ä»¶ç¤ºä¾‹                  | æ˜¾ç¤ºå†…å®¹          |
|-----------+---------------------------+------------------|
| =rust=      | =Cargo.toml=, =*.rs=           | Rust ç‰ˆæœ¬         |
| =python=    | =*.py=, =requirements.txt=     | Python ç‰ˆæœ¬ + venv |
| =nodejs=    | =package.json=, =*.js=         | Node.js ç‰ˆæœ¬      |
| =golang=    | =go.mod=, =*.go=               | Go ç‰ˆæœ¬ + æŒ‡ä»¤ç‰ˆæœ¬ |
| =java=      | =pom.xml=, =*.java=            | Java ç‰ˆæœ¬         |
| =ruby=      | =Gemfile=, =*.rb=              | Ruby ç‰ˆæœ¬         |

*é€šç”¨é…ç½®æ¨¡å¼*:

#+begin_src toml
[rust]
format = 'via [$symbol($version )]($style)'
symbol = 'ğŸ¦€ '
detect_extensions = ['rs']
detect_files = ['Cargo.toml', 'Cargo.lock']
detect_folders = []
style = 'bold red'
disabled = false

[python]
format = 'via [${symbol}${pyenv_prefix}(${version} )(\($virtualenv\) )]($style)'
symbol = 'ğŸ '
pyenv_version_name = false
detect_extensions = ['py', 'ipynb']
detect_files = ['.python-version', 'Pipfile', 'requirements.txt']
detect_folders = ['.venv', 'venv']
detect_env_vars = ['VIRTUAL_ENV', 'CONDA_DEFAULT_ENV']
#+end_src

*ä¼˜åŒ–ç­–ç•¥*: åªä¿ç•™å¸¸ç”¨è¯­è¨€, ç¦ç”¨ä¸éœ€è¦çš„:

#+begin_src toml
[java]
disabled = true

[kotlin]
disabled = true

[haskell]
disabled = true
#+end_src

*** 4. äº‘æœåŠ¡å’Œå®¹å™¨

| æ¨¡å—           | æ˜¾ç¤ºå†…å®¹               | è§¦å‘æ¡ä»¶                    |
|----------------+-----------------------+----------------------------|
| =aws=            | AWS è´¦æˆ· + åŒºåŸŸ        | =AWS_PROFILE= æˆ– credentials |
| =gcloud=         | GCP é¡¹ç›® + åŒºåŸŸ        | =~/.config/gcloud/=          |
| =azure=          | Azure è®¢é˜…            | =~/.azure/=                  |
| =kubernetes=     | K8s context + å‘½åç©ºé—´ | =KUBECONFIG= æˆ– =~/.kube/=     |
| =docker_context= | Docker context        | =docker-compose.yml= ç­‰      |
| =container=      | å®¹å™¨ç¯å¢ƒå              | æ£€æµ‹å®¹å™¨ç¯å¢ƒå˜é‡              |

*é…ç½®ç¤ºä¾‹*:

#+begin_src toml
[aws]
format = 'on [$symbol($profile )(\($region\) )]($style)'
symbol = 'â˜ï¸ '
[aws.region_aliases]
ap-northeast-1 = 'tokyo'
us-east-1 = 'virginia'
[aws.profile_aliases]
CompanyGroupFrobozzOnCallAccess = 'Frobozz'

[kubernetes]
disabled = false
format = 'on [â›µ ($user on )($cluster in )$context \($namespace\)](dimmed green) '
detect_files = ['k8s']
contexts = [
  { context_pattern = "dev.local.cluster.k8s", style = "green", symbol = "ğŸ’” " },
]

[docker_context]
format = 'via [$symbol$context]($style) '
symbol = 'ğŸ³ '
only_with_files = true
detect_files = ['docker-compose.yml', 'Dockerfile']
#+end_src

** æ¨¡å—ç¦ç”¨çš„ä¸¤ç§æ–¹å¼

1. *å®Œå…¨ç¦ç”¨*:

#+begin_src toml
[package]
disabled = true
#+end_src

2. *ä» format ä¸­ç§»é™¤*:

#+begin_src toml
# æ˜¾å¼ format ä¸åŒ…å« $package
format = '$username$hostname$directory$git_branch$character'
#+end_src

* Advanced Configuration: é«˜çº§å®šåˆ¶

** Right Prompt (å³ä¾§æç¤ºç¬¦)

Starship æ”¯æŒåœ¨åŒä¸€è¡Œè¾“å…¥ä½ç½®å³ä¾§æ˜¾ç¤ºä¿¡æ¯ã€‚

*æ”¯æŒçš„ shell*: fish, zsh, elvish, xonsh, cmd, nushell, bash (éœ€è¦ Ble.sh v0.4+)

#+begin_src toml
# å·¦ä¾§ç®€æ´
format = '$character'

# å³ä¾§æ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯
right_format = '''
$cmd_duration\
$git_branch\
$git_status\
$rust\
$python\
$nodejs\
'''
#+end_src

*æ•ˆæœ*:

#+begin_example
â–¶                         on  main [!] via ğŸ¦€ v1.70.0 took 2s
#+end_example

** Transient Prompt (ç¬æ€æç¤ºç¬¦)

*åŠŸèƒ½*: å†å²å‘½ä»¤çš„æç¤ºç¬¦ç®€åŒ–æ˜¾ç¤º, åªä¿ç•™å½“å‰è¡Œçš„å®Œæ•´æç¤ºç¬¦ã€‚

*æ”¯æŒçš„ shell*: fish, bash (Ble.sh v0.4+), PowerShell, Cmd

*** Fish é…ç½®

#+begin_src fish
# ~/.config/fish/config.fish

function starship_transient_prompt_func
  starship module character
end

starship init fish | source
enable_transience
#+end_src

*è‡ªå®šä¹‰å³ä¾§ç¬æ€æç¤º*:

#+begin_src fish
function starship_transient_rprompt_func
  starship module time
end
#+end_src

*** Bash é…ç½® (with Ble.sh)

#+begin_src bash
# ~/.blerc æˆ– ~/.config/blesh/init.sh

bleopt prompt_ps1_transient='trim'

# å·¦ä¾§ç¬æ€æç¤º
bleopt prompt_ps1_final='$(starship module character)'

# å³ä¾§ç¬æ€æç¤º
bleopt prompt_rps1_final='$(starship module time)'
#+end_src

** Continuation Prompt (ç»­è¡Œæç¤ºç¬¦)

*åŠŸèƒ½*: å¤šè¡Œè¾“å…¥æ—¶, åç»­è¡Œçš„æç¤ºç¬¦ã€‚

*æ”¯æŒçš„ shell*: bash, zsh, PowerShell

#+begin_src toml
continuation_prompt = 'â–¶â–¶ '
#+end_src

*é»˜è®¤å€¼*: ='[âˆ™](bright-black) '=

** è‡ªå®šä¹‰ Pre-Prompt å’Œ Pre-Exec é’©å­

*** Bash ç¤ºä¾‹

#+begin_src bash
# ~/.bashrc

# åœ¨æç¤ºç¬¦ç»˜åˆ¶å‰æ‰§è¡Œ
function blastoff() {
    echo "ğŸš€"
}
starship_precmd_user_func="blastoff"

# åœ¨å‘½ä»¤æ‰§è¡Œå‰è¿è¡Œ
function pre_exec() {
    echo "Executing: $1"
}
trap pre_exec DEBUG  # å¿…é¡»åœ¨ starship init ä¹‹å‰
set -o functrace
eval $(starship init bash)
set +o functrace
#+end_src

*** PowerShell ç¤ºä¾‹

#+begin_src powershell
# $PROFILE

function Invoke-Starship-PreCommand {
    $host.ui.Write("ğŸš€")
}

Invoke-Expression (&starship init powershell)
#+end_src

** ä¿®æ”¹ç»ˆç«¯çª—å£æ ‡é¢˜

*Bash / Zsh*:

#+begin_src bash
# ~/.bashrc æˆ– ~/.zshrc

function set_win_title() {
    echo -ne "\033]0; $(basename "$PWD") \007"
}

# Bash
starship_precmd_user_func="set_win_title"

# Zsh
precmd_functions+=(set_win_title)
#+end_src

* æ ·å¼ç³»ç»Ÿ (Style Strings)

** åŸºç¡€è¯­æ³•

#+begin_src
'[modifier] [modifier] fg:<color> bg:<color>'
#+end_src

*Modifiers*:
- =bold=
- =italic=
- =underline=
- =dimmed=
- =inverted= (å‰æ™¯èƒŒæ™¯äº’æ¢)
- =strikethrough=
- =blink= (å¤§å¤šç»ˆç«¯é»˜è®¤ç¦ç”¨)
- =hidden= (iTerm ä¸æ”¯æŒ)

*ç¤ºä¾‹*:

#+begin_src toml
style = 'bold fg:green bg:blue'
style = 'underline bg:#bf5700'
style = 'bold italic fg:purple'
#+end_src

** é¢œè‰²ç³»ç»Ÿ

*** 1. æ ‡å‡† 16 è‰²

=black=, =red=, =green=, =yellow=, =blue=, =purple=, =cyan=, =white=

*é«˜äº®ç‰ˆæœ¬*: åŠ  =bright-= å‰ç¼€

#+begin_src toml
style = 'bright-red'
style = 'fg:bright-cyan bg:black'
#+end_src

*** 2. 256 è‰² (ANSI)

ä½¿ç”¨æ•°å­— =0-255=

#+begin_src toml
style = 'fg:27'     # äº®è“
style = 'bold fg:208'  # æ©™è‰²
#+end_src

*** 3. RGB çœŸå½©è‰²

=#RRGGBB= æ ¼å¼

#+begin_src toml
style = 'fg:#af8700'
style = 'bg:#1e1e2e'
#+end_src

*** 4. ç‰¹æ®Šé¢œè‰²å€¼

- =prev_fg= / =prev_bg=: ç»§æ‰¿å‰ä¸€å…ƒç´ çš„é¢œè‰²
- =none=: ç¦ç”¨æ‰€æœ‰æ ·å¼ (è¦†ç›–å…¶ä»–è®¾ç½®)

#+begin_src toml
format = '[$symbol](red)[$branch](prev_fg underline)'
# branch ç»§æ‰¿ symbol çš„çº¢è‰², å¹¶åŠ ä¸‹åˆ’çº¿
#+end_src

** Palette ç³»ç»Ÿ (é¢œè‰²è°ƒè‰²æ¿)

*ç”¨é€”*: é›†ä¸­å®šä¹‰é¢œè‰²æ–¹æ¡ˆ, ä¾¿äºä¸»é¢˜åˆ‡æ¢ã€‚

#+begin_src toml
palette = 'catppuccin_mochiato'

[palettes.catppuccin_mochiato]
rosewater = '#f4dbd6'
flamingo = '#f0c6c6'
pink = '#f5bde6'
mauve = '#c6a0f6'
red = '#ed8796'
maroon = '#ee99a0'
peach = '#f5a97f'
yellow = '#eed49f'
green = '#a6da95'
teal = '#8bd5ca'
sky = '#91d7e3'
sapphire = '#7dc4e4'
blue = '#8aadf4'
lavender = '#b7bdf8'

[palettes.nord]
polar_night = '#2e3440'
snow_storm = '#eceff4'
frost = '#88c0d0'
aurora_red = '#bf616a'
aurora_orange = '#d08770'
aurora_yellow = '#ebcb8b'
aurora_green = '#a3be8c'
aurora_purple = '#b48ead'
#+end_src

*ä½¿ç”¨æ–¹å¼*:

#+begin_src toml
[directory]
style = 'bold blue'  # ä½¿ç”¨ palette ä¸­å®šä¹‰çš„ blue

[git_branch]
style = 'fg:green bg:polar_night'  # ç»„åˆ palette é¢œè‰²
#+end_src

*åˆ‡æ¢ä¸»é¢˜*:

#+begin_src toml
palette = 'nord'  # åªéœ€æ”¹ä¸€è¡Œ
#+end_src

* å®æˆ˜é…ç½®ç­–ç•¥

** ç­–ç•¥ 1: æç®€é…ç½® (Minimal)

*ç›®æ ‡*: åªæ˜¾ç¤ºæ ¸å¿ƒä¿¡æ¯, æœ€å¿«å“åº”ã€‚

#+begin_src toml
format = '''
$directory\
$git_branch\
$git_status\
$character
'''

[directory]
truncation_length = 3
truncate_to_repo = true

[git_branch]
format = '[$symbol$branch]($style) '

[git_status]
format = '([$all_status$ahead_behind]($style) )'

[character]
success_symbol = '[â¯](bold green)'
error_symbol = '[â¯](bold red)'

# ç¦ç”¨æ‰€æœ‰è¯­è¨€æ¨¡å—
[rust]
disabled = true
[python]
disabled = true
[nodejs]
disabled = true
# ... å…¶ä»–è¯­è¨€
#+end_src

** ç­–ç•¥ 2: å¼€å‘è€…é…ç½® (Developer-Focused)

*ç›®æ ‡*: æ˜¾ç¤ºå¸¸ç”¨è¯­è¨€ç‰ˆæœ¬ã€Git ä¿¡æ¯ã€æ‰§è¡Œæ—¶é—´ã€‚

#+begin_src toml
format = '''
$username\
$hostname\
$directory\
$git_branch\
$git_status\
$rust\
$python\
$nodejs\
$golang\
$cmd_duration\
$line_break\
$character
'''

[cmd_duration]
min_time = 1000
format = 'took [$duration]($style) '

[git_branch]
format = 'on [$symbol$branch(:$remote_branch)]($style) '

[git_status]
ahead = 'â‡¡${count}'
behind = 'â‡£${count}'
diverged = 'â‡•â‡¡${ahead_count}â‡£${behind_count}'

[rust]
format = 'via [$symbol($version )]($style)'

[python]
format = 'via [$symbol$pyenv_prefix($version )(\($virtualenv\) )]($style)'
detect_extensions = ['py', 'ipynb']

[nodejs]
format = 'via [$symbol($version )]($style)'
detect_files = ['package.json']
#+end_src

** ç­–ç•¥ 3: åŒæ é…ç½® (Two-Line / Right Prompt)

*ç›®æ ‡*: å·¦ä¾§æ˜¾ç¤ºæ ¸å¿ƒä¿¡æ¯, å³ä¾§æ˜¾ç¤ºè¾…åŠ©ä¿¡æ¯ã€‚

#+begin_src toml
# å·¦ä¾§: è·¯å¾„ + Git + è¯­è¨€
format = '''
$directory\
$git_branch\
$git_status\
$rust\
$python\
$line_break\
$character
'''

# å³ä¾§: æ—¶é—´ + å‘½ä»¤è€—æ—¶ + äº‘æœåŠ¡
right_format = '''
$cmd_duration\
$time\
$aws\
$kubernetes
'''

[time]
disabled = false
format = '[$time]($style) '
time_format = '%T'

[cmd_duration]
min_time = 0  # æ€»æ˜¯æ˜¾ç¤º

[kubernetes]
disabled = false
format = '[$symbol$context( \($namespace\))]($style) '
#+end_src

** ç­–ç•¥ 4: æ€§èƒ½ä¼˜åŒ–é…ç½®

*é—®é¢˜*: ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ (NFS/SMB) æˆ–å¤§å‹ä»“åº“å¯¼è‡´ prompt å¡é¡¿ã€‚

*ä¼˜åŒ–æ–¹å‘*:

1. å‡å°‘æ–‡ä»¶æ‰«æ

#+begin_src toml
scan_timeout = 10  # é™ä½æ‰«æè¶…æ—¶
follow_symlinks = false  # ä¸è·Ÿéšç¬¦å·é“¾æ¥
#+end_src

2. ç¦ç”¨ä¸éœ€è¦çš„æ¨¡å—

#+begin_src toml
[git_metrics]
disabled = true  # è€—æ—¶çš„ git diff ç»Ÿè®¡

[git_status]
disabled = false
# æˆ–è€…åªæ£€æŸ¥å…³é”®çŠ¶æ€
ahead = 'â‡¡'
behind = 'â‡£'
diverged = 'â‡•'
untracked = ''
stashed = ''
modified = ''
#+end_src

3. ä½¿ç”¨ç¯å¢ƒå˜é‡è§¦å‘

#+begin_src toml
[python]
detect_extensions = []  # ä¸é€šè¿‡æ–‡ä»¶æ‰©å±•åè§¦å‘
detect_files = []
detect_env_vars = ['VIRTUAL_ENV']  # åªé€šè¿‡ç¯å¢ƒå˜é‡
#+end_src

* è°ƒè¯•å’Œæ•…éšœæ’æŸ¥

** æŸ¥çœ‹å½“å‰é…ç½®

#+begin_src bash
starship explain
#+end_src

*è¾“å‡º*: å½“å‰æ˜¾ç¤ºçš„æ¯ä¸ªæ¨¡å—çš„é…ç½®å’Œæ•°æ®æ¥æºã€‚

** å¯ç”¨è°ƒè¯•æ—¥å¿—

#+begin_src bash
# è®¾ç½®æ—¥å¿—çº§åˆ«
export STARSHIP_LOG=trace

# é’ˆå¯¹ç‰¹å®šæ¨¡å—
starship module rust
#+end_src

** æ€§èƒ½åˆ†æ

#+begin_src bash
starship timings
#+end_src

*è¾“å‡º*: æ¯ä¸ªæ¨¡å—çš„æ‰§è¡Œè€—æ—¶, å¿«é€Ÿå®šä½æ…¢æ¨¡å—ã€‚

** é…ç½®éªŒè¯

#+begin_src bash
starship config
#+end_src

*åŠŸèƒ½*: æ£€æŸ¥ =starship.toml= è¯­æ³•é”™è¯¯ã€‚

** å¸¸è§é—®é¢˜

*** 1. æ¨¡å—ä¸æ˜¾ç¤º

*æ£€æŸ¥é¡ºåº*:
1. æ¨¡å—æ˜¯å¦åœ¨ =format= ä¸­?
2. =disabled = false= ?
3. æ£€æµ‹æ¡ä»¶æ˜¯å¦æ»¡è¶³?
4. ç”¨ =starship explain= æŸ¥çœ‹åŸå› 

*** 2. å›¾æ ‡æ˜¾ç¤ºä¸ºæ–¹å—

*åŸå› *: ç»ˆç«¯æœªä½¿ç”¨ Nerd Fontã€‚

*è§£å†³*: å®‰è£… Nerd Font (å¦‚ =FiraCode Nerd Font=), å¹¶åœ¨ç»ˆç«¯é…ç½®ä¸­è®¾ç½®ã€‚

*** 3. æç¤ºç¬¦å»¶è¿Ÿé«˜

*æ’æŸ¥*:
1. =starship timings= æ‰¾åˆ°æ…¢æ¨¡å—
2. æ£€æŸ¥æ˜¯å¦åœ¨ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ
3. é™ä½ =scan_timeout= æˆ– =command_timeout=
4. ç¦ç”¨ =git_metrics=

* Ghostty ç‰¹å®šæ³¨æ„äº‹é¡¹

Ghostty æ˜¯ä¸€æ¬¾ç°ä»£ç»ˆç«¯æ¨¡æ‹Ÿå™¨, å¯¹ Starship çš„æ”¯æŒæƒ…å†µ:

1. *Right Prompt*: Ghostty æ”¯æŒ right prompt (é€šè¿‡æ ‡å‡† escape sequences)
2. *True Color*: å®Œæ•´æ”¯æŒ 24-bit RGB é¢œè‰²
3. *Ligatures*: æ”¯æŒå­—ä½“è¿å­— (éœ€è¦ Nerd Font)
4. *Transient Prompt*: æ”¯æŒ (åŸºäº shell å®ç°)

*æ¨èé…ç½®*:

#+begin_src toml
# åˆ©ç”¨ Ghostty çš„çœŸå½©è‰²æ”¯æŒ
[directory]
style = 'bold fg:#8aadf4'

[git_branch]
style = 'fg:#a6da95'

# ä½¿ç”¨ Right Prompt
right_format = '$cmd_duration$time'
#+end_src

* é…ç½®æ–‡ä»¶ç®¡ç†æœ€ä½³å®è·µ

** 1. ç‰ˆæœ¬æ§åˆ¶

#+begin_src bash
# ç¬¦å·é“¾æ¥åˆ° dotfiles ä»“åº“
ln -s ~/dotfiles/starship.toml ~/.config/starship.toml
#+end_src

** 2. æ¡ä»¶é…ç½® (åŸºäºä¸»æœº)

Starship æœ¬èº«ä¸æ”¯æŒæ¡ä»¶é…ç½®, ä½†å¯ä»¥é€šè¿‡ shell è„šæœ¬å®ç°:

#+begin_src bash
# ~/.bashrc

if [[ $(hostname) == "work-laptop" ]]; then
    export STARSHIP_CONFIG=~/.config/starship-work.toml
else
    export STARSHIP_CONFIG=~/.config/starship-personal.toml
fi

eval "$(starship init bash)"
#+end_src

** 3. æ¨¡å—åŒ–é…ç½® (ä¸æ”¯æŒ)

*æ³¨æ„*: Starship ä¸æ”¯æŒ =include= æˆ– =import=ã€‚æ‰€æœ‰é…ç½®å¿…é¡»åœ¨å•ä¸€æ–‡ä»¶ä¸­ã€‚

** 4. é…ç½®æµ‹è¯•

#+begin_src bash
# ä½¿ç”¨ä¸´æ—¶é…ç½®æµ‹è¯•
STARSHIP_CONFIG=~/test-starship.toml bash
#+end_src

* æ€»ç»“: é…ç½®å†³ç­–æ ‘

#+begin_example
æ˜¯å¦éœ€è¦é«˜æ€§èƒ½? (ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ/å¤§å‹ä»“åº“)
â”œâ”€ æ˜¯ â†’ æç®€é…ç½® + ç¦ç”¨æ…¢æ¨¡å— (git_metrics, å¤šæ•°è¯­è¨€æ£€æµ‹)
â””â”€ å¦
    â”‚
    â”œâ”€ ä¸»è¦å¼€å‘åœºæ™¯?
    â”‚   â”œâ”€ å•è¯­è¨€é¡¹ç›® â†’ åªå¯ç”¨è¯¥è¯­è¨€æ¨¡å—
    â”‚   â”œâ”€ å¤šè¯­è¨€é¡¹ç›® â†’ å¯ç”¨æ‰€æœ‰å¸¸ç”¨è¯­è¨€
    â”‚   â””â”€ äº‘åŸç”Ÿå¼€å‘ â†’ å¯ç”¨ k8s, docker, aws/gcp
    â”‚
    â”œâ”€ å±å¹•å®½åº¦?
    â”‚   â”œâ”€ çª„å± (<100 åˆ—) â†’ åŒè¡Œé…ç½®æˆ– right_format
    â”‚   â””â”€ å®½å± â†’ å•è¡Œé…ç½®
    â”‚
    â””â”€ è§†è§‰åå¥½?
        â”œâ”€ æç®€ â†’ å°‘ç¬¦å·, çŸ­ format, æ— é¢œè‰²
        â””â”€ ä¸°å¯Œ â†’ Palette ç³»ç»Ÿ, å¤šç¬¦å·, å……åˆ†åˆ©ç”¨é¢œè‰²
#+end_example

*æ ¸å¿ƒåŸåˆ™*:
1. åªå¯ç”¨çœŸæ­£éœ€è¦çš„æ¨¡å—
2. ä¼˜å…ˆä½¿ç”¨ç¯å¢ƒå˜é‡è§¦å‘è€Œéæ–‡ä»¶æ‰«æ
3. é’ˆå¯¹æ…¢é€Ÿç¯å¢ƒ (ç½‘ç»œç›˜, WSL) æ¿€è¿›ä¼˜åŒ–
4. å®šæœŸç”¨ =starship timings= å®¡æŸ¥æ€§èƒ½
